<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><meta name="google-site-verification" content="hwu96hHsSnPefhY5oj_Q2reBfC1YuVkwbsuPeuAjSls"><meta name="baidu-site-verification" content="codeva-1TKHma47RE"><script>!function(t,e,n,c,r,a){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(r=e.createElement(c)).async=1,r.src="https://www.clarity.ms/tag/cnl2uzz0vb?ref=bwt",(a=e.getElementsByTagName(c)[0]).parentNode.insertBefore(r,a)}(window,document,"clarity","script")</script><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic%7CPingFang+SC:300,300italic,400,400italic,700,700italic%7CMicrosoft+YaHei:300,300italic,400,400italic,700,700italic%7Csans-serif:300,300italic,400,400italic,700,700italic%7CLato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"www.pengtech.net","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":"enable","bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script><meta name="description" content="1. 原文原文how to build RPM Author: Chris Negus Editor: Allison Pranger Date: 09&#x2F;16&#x2F;2011 译者：philoenglish.com 团队 2. 概览您已经创建了一些要安装在Red Hat Enterprise Linux系统上的软件。现在的问题是，“软件编写完成后，如何打包该软件以使其他人易于安装和管理？” 答案是将其打"><meta property="og:type" content="article"><meta property="og:title" content="如何制作RPM安装包"><meta property="og:url" content="https://www.pengtech.net/linux/how_to_create_rpm_package.html"><meta property="og:site_name" content="鹏叔的技术博客"><meta property="og:description" content="1. 原文原文how to build RPM Author: Chris Negus Editor: Allison Pranger Date: 09&#x2F;16&#x2F;2011 译者：philoenglish.com 团队 2. 概览您已经创建了一些要安装在Red Hat Enterprise Linux系统上的软件。现在的问题是，“软件编写完成后，如何打包该软件以使其他人易于安装和管理？” 答案是将其打"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2021-10-27T16:00:00.000Z"><meta property="article:modified_time" content="2024-05-01T18:12:12.569Z"><meta property="article:author" content="鹏叔"><meta property="article:tag" content="linux"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.pengtech.net/linux/how_to_create_rpm_package.html"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.pengtech.net/linux/how_to_create_rpm_package.html","path":"linux/how_to_create_rpm_package.html","title":"如何制作RPM安装包"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>如何制作RPM安装包 | 鹏叔的技术博客</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZZTM0Y954E"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-ZZTM0Y954E","only_pageview":false}</script><script src="/js/third-party/analytics/google-analytics.js"></script><script src="/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?1da0f55a32eb17a877b1b18efa3d0406"></script><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i> <span class="site-title h1">鹏叔的技术博客</span> <i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">日拱一卒，功不唐捐!</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-angular"><a href="/angular/" rel="section"><i class="fa fa-th fa-fw"></i>angular</a></li><li class="menu-item menu-item-material-design"><a href="/material-design/" rel="section"><i class="fa fa-th fa-fw"></i>material-design</a></li><li class="menu-item menu-item-linux"><a href="/linux/" rel="section"><i class="fa fa-cube fa-fw"></i>linux</a></li><li class="menu-item menu-item-gitlab"><a href="/gitlab/" rel="section"><i class="fa fa-th fa-fw"></i>gitlab</a></li><li class="menu-item menu-item-frontend"><a href="/frontend/" rel="section"><i class="fa fa-mobile fa-fw"></i>frontend</a></li><li class="menu-item menu-item-backend"><a href="/backend/" rel="section"><i class="fa fa-mobile fa-fw"></i>backend</a></li><li class="menu-item menu-item-vscode"><a href="/vscode/" rel="section"><i class="fa fa-th fa-fw"></i>vscode</a></li><li class="menu-item menu-item-hexo"><a href="/hexo/" rel="section"><i class="fa fa-sitemap fa-fw"></i>hexo</a></li><li class="menu-item menu-item-java"><a href="/java/" rel="section"><i class="fa fa-coffee fa-fw"></i>java</a></li><li class="menu-item menu-item-golang"><a href="/golang/" rel="section"><i class="fa fa-cloud fa-fw"></i>golang</a></li><li class="menu-item menu-item-v2raya"><a href="/v2rayA/" rel="section"><i class="fa fa-cloud fa-fw"></i>v2rayA</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%8E%9F%E6%96%87"><span class="nav-number">1.</span> <span class="nav-text">1. 原文</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%A6%82%E8%A7%88"><span class="nav-number">2.</span> <span class="nav-text">2. 概览</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%88%9D%E6%AD%A5%E7%90%86%E8%A7%A3RPMS%E7%9A%84%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B"><span class="nav-number">3.</span> <span class="nav-text">3. 初步理解RPMS的构建过程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E4%BA%86%E8%A7%A3RPMS%E7%9A%84%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B"><span class="nav-number">3.1.</span> <span class="nav-text">3.1. 了解RPMS的构建过程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E5%B0%86%E7%8E%B0%E6%9C%89%E7%9A%84%E6%BA%90%E4%BB%A3%E7%A0%81%E5%8C%85%E9%87%8D%E5%BB%BA%E4%B8%BARPM"><span class="nav-number">4.</span> <span class="nav-text">4. 将现有的源代码包重建为RPM</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-%E6%9E%84%E5%BB%BARPM"><span class="nav-number">4.1.</span> <span class="nav-text">4.5. 构建RPM</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-%E7%AD%BE%E5%90%8DRPM"><span class="nav-number">4.2.</span> <span class="nav-text">4.6. 签名RPM</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-7-%E5%9C%A8yum%E5%AD%98%E5%82%A8%E5%BA%93%E4%B8%AD%E5%8F%91%E5%B8%83RPM"><span class="nav-number">4.3.</span> <span class="nav-text">4.7. 在yum存储库中发布RPM</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-8-%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E5%BA%93%EF%BC%88-repo%EF%BC%89%E6%96%87%E4%BB%B6"><span class="nav-number">4.4.</span> <span class="nav-text">4.8. 创建存储库（.repo）文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-9-%E5%87%86%E5%A4%87%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A5%E5%AE%89%E8%A3%85RPM"><span class="nav-number">4.5.</span> <span class="nav-text">4.9. 准备客户端以安装RPM</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-10-%E6%A3%80%E6%9F%A5%E6%82%A8%E7%9A%84RPM%E5%8C%85%E8%A3%85"><span class="nav-number">4.6.</span> <span class="nav-text">4.10. 检查您的RPM包装</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-10-1-%E9%A6%96%E5%85%88%E5%AF%BC%E5%85%A5%E7%94%A8%E4%BA%8E%E7%AD%BE%E5%90%8D%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%9A%84%E5%AF%86%E9%92%A5%E5%B9%B6%E6%A3%80%E6%9F%A5%E7%AD%BE%E5%90%8D"><span class="nav-number">4.6.1.</span> <span class="nav-text">4.10.1. 首先导入用于签名软件包的密钥并检查签名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-10-2-%E6%8E%A5%E4%B8%8B%E6%9D%A5%EF%BC%8C%E6%A3%80%E6%9F%A5%E6%96%87%E4%BB%B6%E7%9A%84%E5%86%85%E5%AE%B9"><span class="nav-number">4.6.2.</span> <span class="nav-text">4.10.2. 接下来，检查文件的内容</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E6%9E%84%E5%BB%BARPM"><span class="nav-number">5.</span> <span class="nav-text">5. 从零开始构建RPM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E8%8E%B7%E5%BE%97%E6%9B%B4%E5%A4%9A%E5%85%B3%E4%BA%8ERPMS%E7%9A%84%E5%B8%AE%E5%8A%A9"><span class="nav-number">6.</span> <span class="nav-text">6. 获得更多关于RPMS的帮助</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3"><span class="nav-number">7.</span> <span class="nav-text">参考文档</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="鹏叔" src="/imgs/avatar.gif"><p class="site-author-name" itemprop="name">鹏叔</p><div class="site-description" itemprop="description">鹏叔的技术博客, 鹏叔的技术博客, 收集鹏叔在日常工作中整理的技术博客, 内容包括前端javascript, material design, typescript, css, html, 后端golang, java, 数据库等.</div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">250</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">35</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">76</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://github.com/guoapeng" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;guoapeng" rel="noopener external nofollow" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:guoapeng@gmail.com" title="E-Mail → mailto:guoapeng@gmail.com" rel="noopener external nofollow" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a></span></div><div class="cc-license site-overview-item animated" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" class="cc-opacity" rel="noopener external nofollow" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll site-overview-item animated"><div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://philoenglish.com/" title="https:&#x2F;&#x2F;philoenglish.com" target="_blank">菲利英语</a></li></ul></div></div></div><div class="back-to-top animated" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div class="sidebar-dimmer"></div></header><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.pengtech.net/linux/how_to_create_rpm_package.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/imgs/avatar.gif"><meta itemprop="name" content="鹏叔"><meta itemprop="description" content="鹏叔的技术博客, 鹏叔的技术博客, 收集鹏叔在日常工作中整理的技术博客, 内容包括前端javascript, material design, typescript, css, html, 后端golang, java, 数据库等."></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="鹏叔的技术博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">如何制作RPM安装包</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-10-28 00:00:00" itemprop="dateCreated datePublished" datetime="2021-10-28T00:00:00+08:00">2021-10-28</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2024-05-02 02:12:12" itemprop="dateModified" datetime="2024-05-02T02:12:12+08:00">2024-05-02</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/OS/" itemprop="url" rel="index"><span itemprop="name">OS</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/OS/devops/" itemprop="url" rel="index"><span itemprop="name">devops</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/OS/devops/backend/" itemprop="url" rel="index"><span itemprop="name">backend</span></a> </span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv"><span class="post-meta-item-icon"><i class="far fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span> </span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>7.9k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>7 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="1-原文"><a href="#1-原文" class="headerlink" title="1. 原文"></a>1. 原文</h2><p>原文<a target="_blank" rel="noopener" href="https://access.redhat.com/sites/default/files/attachments/rpm_building_howto.pdf">how to build RPM</a></p><p>Author: Chris Negus</p><p>Editor: Allison Pranger</p><p>Date: 09/16/2011</p><p>译者：<a target="_blank" rel="noopener" href="https://philoenglish.com/">philoenglish.com</a> 团队</p><h2 id="2-概览"><a href="#2-概览" class="headerlink" title="2. 概览"></a>2. 概览</h2><p>您已经创建了一些要安装在Red Hat Enterprise Linux系统上的软件。现在的问题是，“软件编写完成后，如何打包该软件以使其他人易于安装和管理？”</p><p>答案是将其打包成RPM安装包。</p><p>尽管有其他方式，可以将软件打包成特定格式的压缩包（通过压缩包或其他类型的存档文件）通过解压缩的方式安装到Linux系统，但是将Linux软件打包为RPM，可以为您带来一下好处：</p><ul><li><p>在包中包括描述其组件，版本号，大小，包的元数据, 组，项目网址等待信息。</p></li><li><p>将软件包添加到yum存储库，以便客户可以轻松找到您的软件</p></li><li><p>让客户端使用常见的Linux工具（yum，rpm和PackageKit）来安装，删除和管理您的软件。</p></li><li><p>使用相同的Linux安装工具轻松更新和部署软件的新版本</p></li></ul><p>您无需成为程序员即可创建RPM：只需了解如何创建SPEC文件并使用命令来构建该SPEC文件, 并将内容打包到RPM中。如何打包RPM格式的安装包是本文要详述的内容。创建RPM安装包不仅对管理公司的软件有用，而且也被列为红帽认证工程师（RHCE）考试技能测试范畴。</p><span id="more"></span><h2 id="3-初步理解RPMS的构建过程"><a href="#3-初步理解RPMS的构建过程" class="headerlink" title="3. 初步理解RPMS的构建过程"></a>3. 初步理解RPMS的构建过程</h2><h3 id="3-1-了解RPMS的构建过程"><a href="#3-1-了解RPMS的构建过程" class="headerlink" title="3.1. 了解RPMS的构建过程"></a>3.1. 了解RPMS的构建过程</h3><p>创建RPM包需要了解如何使用文本编辑器以及如何运行一些创建,签名，发布命令</p><p>需要打包的软件准备好以后，构建RPM所需的大部分工作是编辑RPM SPEC文件。</p><p>在SPEC文件中，您可以：</p><ul><li><p>确定软件包中的命令，配置文件，文档和其他项目</p></li><li><p>定义最终在目标Linux系统上安装组件的位置</p></li><li><p>设置每个文件的权限和所有权</p></li><li><p>定义依赖包</p></li><li><p>将文件标记为配置文件或文档文件</p></li><li><p>定义安装或卸载时需要额外执行的命令（例如创建用户帐户，创建目录或移动文件）</p></li><li><p>添加变更日志，以识别您的每个软件版本中进行了哪些更改</p></li></ul><p>一旦掌握了构建RPM的基本功能（如本文档所述），您便可以会发现大量强大灵活的RPM打包工具帮助您创建RPM。</p><p>例如，您可以将平台特定的标签添加到SPEC文件，以便可以使用相同的标签。使用同样的SPEC文件来为多种计算机体系结构构建RPM。</p><h2 id="4-将现有的源代码包重建为RPM"><a href="#4-将现有的源代码包重建为RPM" class="headerlink" title="4. 将现有的源代码包重建为RPM"></a>4. 将现有的源代码包重建为RPM</h2><p>学习如何创建RPM软件包的最好方法是从现有的源代码RPM软件包开始,并重建它。</p><p>通过该过程，您可以明白创建RPM包所涉及的过程和组件。本节概述了从现有资源重建tree RPM软件包的步骤。</p><blockquote><p>注意：构建此RPM后，请勿在生产系统上使用它，因为该软件包将与一个已经存于Red Hat Enterprise Linux软件频道中的RPM包产生冲突。</p></blockquote><ol><li><p>登录：以普通用户（非root用户）身份登录Red Hat Enterprise Linux系统</p></li><li><p>获取源代码包：下载有效的源代码包。 本示例使用的源代码包</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">wget ftp://ftp.redhat.com/pub/redhat/linux/enterprise/6Workstation/en/os/SRPMS/tree-1.5.3-2.el6.src.rpm</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>安装源代码：将源代码安装到新的~/rpmbuild目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">rpm -ihv tree-1.5.3-2.el6.src.rpm</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这将在您的主目录中创建一个rpmbuild目录结构，类似于以下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">~/SPECS</span><br><span class="line"></span><br><span class="line">~/SPECS/tree.spec</span><br><span class="line"></span><br><span class="line">~/BUILDROOT</span><br><span class="line"></span><br><span class="line">~/SOURCES</span><br><span class="line"></span><br><span class="line">~/SOURCES/tree-1.5.3.tgz</span><br><span class="line"></span><br><span class="line">~/SOURCES/tree-1.2-no-strip.patch</span><br><span class="line"></span><br><span class="line">~/SOURCES/tree-no-color-by-default.patch</span><br><span class="line"></span><br><span class="line">~/SOURCES/tree-1.2-carrot.patch</span><br><span class="line"></span><br><span class="line">~/SOURCES/tree-preserve-timestamps.patch</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>注意：您的主目录中的新rpmbuild目录包括一个SPECS目录（该目录包括tree.spec文件）和SOURCES目录。 SOURCES目录包含代码的tree1.5.3.tgz压缩文件和四个补丁文件。</p></blockquote></li><li><p>编辑规格文件：查看规格文件。 使用vim或emacs编辑器会在编辑文件时为文件添加颜色</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">vim ~/rpmbuild/SPECS/tree.spec</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>示例文件的内容如下所示。 完成更改后，保存并退出文件。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Summary: File system tree viewer</span><br><span class="line"></span><br><span class="line">Name: tree</span><br><span class="line"></span><br><span class="line">Version: 1.5.3</span><br><span class="line"></span><br><span class="line">Release: 2%&#123;?dist&#125;</span><br><span class="line"></span><br><span class="line">Group: Applications/File</span><br><span class="line"></span><br><span class="line">License: GPLv2+</span><br><span class="line"></span><br><span class="line">Url: http://mama.indstate.edu/users/ice/tree/</span><br><span class="line"></span><br><span class="line">Source: ftp://mama.indstate.edu/linux/tree/tree-%&#123;version&#125;.tgz</span><br><span class="line"></span><br><span class="line">Patch1: tree-1.2-carrot.patch</span><br><span class="line"></span><br><span class="line">Patch2: tree-1.2-no-strip.patch</span><br><span class="line"></span><br><span class="line">Patch3: tree-preserve-timestamps.patch</span><br><span class="line"></span><br><span class="line">Patch4: tree-no-color-by-default.patch</span><br><span class="line"></span><br><span class="line">BuildRoot: %&#123;_tmppath&#125;/%&#123;name&#125;-%&#123;version&#125;-%&#123;release&#125;-root-%(%&#123;__id_u&#125; -n)</span><br><span class="line"></span><br><span class="line">%description</span><br><span class="line"></span><br><span class="line">The tree utility recursively displays the contents of directories in a treelike format. Tree is basically a UNIX port of the DOS tree utility.%prep</span><br><span class="line"></span><br><span class="line">%setup -q</span><br><span class="line"></span><br><span class="line"># Fixed spelling mistake in man page.</span><br><span class="line"></span><br><span class="line">%patch1 -p1 -b .carrot</span><br><span class="line"></span><br><span class="line"># Don&#x27;t strip binary in the Makefile -- let rpmbuild do it.</span><br><span class="line"></span><br><span class="line">%patch2 -p1 -b .no-strip</span><br><span class="line"></span><br><span class="line"># Preserve timestamp on man page.</span><br><span class="line"></span><br><span class="line">%patch3 -p1 -b .preserve-timestamps</span><br><span class="line"></span><br><span class="line"># Disable color output by default.</span><br><span class="line"></span><br><span class="line">%patch4 -p1 -b .no-color-by-default</span><br><span class="line"></span><br><span class="line">%build</span><br><span class="line"></span><br><span class="line">make CFLAGS=&quot;$RPM_OPT_FLAGS&quot; &quot;CPPFLAGS=$(getconf LFS_CFLAGS)&quot; %&#123;?_smp_mlags&#125;</span><br><span class="line"></span><br><span class="line">%install</span><br><span class="line"></span><br><span class="line">rm -rf $RPM_BUILD_ROOT</span><br><span class="line"></span><br><span class="line">mkdir -p $RPM_BUILD_ROOT%&#123;_bindir&#125;</span><br><span class="line"></span><br><span class="line">make BINDIR=$RPM_BUILD_ROOT%&#123;_bindir&#125; \</span><br><span class="line"></span><br><span class="line">MANDIR=$RPM_BUILD_ROOT%&#123;_mandir&#125;/man1 \</span><br><span class="line"></span><br><span class="line">install</span><br><span class="line"></span><br><span class="line">chmod -x $RPM_BUILD_ROOT%&#123;_mandir&#125;/man1/tree.1</span><br><span class="line"></span><br><span class="line">%clean</span><br><span class="line"></span><br><span class="line">rm -rf $RPM_BUILD_ROOT</span><br><span class="line"></span><br><span class="line">%files</span><br><span class="line"></span><br><span class="line">%defattr(-,root,root)</span><br><span class="line"></span><br><span class="line">%&#123;_bindir&#125;/tree</span><br><span class="line"></span><br><span class="line">%&#123;_mandir&#125;/man1/tree.1*</span><br><span class="line"></span><br><span class="line">%doc README LICENSE</span><br><span class="line"></span><br><span class="line">%changelo</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol><p>安装rpm-build软件包后，您可以在以下位置阅读有关SPEC文件功能的信息：</p><p>/usr/share/doc/rpm-build*/spec文件。</p><p>name是程序包的base name,</p><p>summary是该程序包的单行说明,</p><p>Version是upstream版本号包，</p><p>而Release是您作为打包者添加的编号，以反映该版本的多个版本</p><p>相同的上游版本（例如错误修复）,</p><p>URL指向生成源代码的项目站点，</p><p>Source指向用于制作程序包的原始源代码,</p><p>BuildRoot标识位置RPM的临时目录,</p><p>其他行准备构建环境，添加</p><p>修补，编译和构建软件，标识软件包中的文件和权限，以及</p><p>允许您记录随时间变化的日志。</p><p>在本文档的最后，您可以找到一些rpm -qp选项，可用于检查</p><p>您构建的软件包的内容。</p><h3 id="4-5-构建RPM"><a href="#4-5-构建RPM" class="headerlink" title="4.5. 构建RPM"></a>4.5. 构建RPM</h3><p>使用rpmbuild命令将您的spec file和内容转换为RPM包， 您还可以将源代码打包到单独的源RPM(src.rpm)中。</p><p>安装rpm-build软件包（以root用户身份）并运行rpmbuild（普通用户）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Run as root</span></span><br><span class="line"></span><br><span class="line">$ sudo yum install rpm-build</span><br><span class="line"></span><br><span class="line"><span class="comment">#Run as regular user account</span></span><br><span class="line"></span><br><span class="line">$ rpmbuild -ba ~/rpmbuild/SPECS/tree.spec</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>-ba 编译后做成*.rpm和src.rpm</p></blockquote><p>这样会在RPMS和SRPMS子目录中分别生成二进制RPM包和源码RPM包。</p><h3 id="4-6-签名RPM"><a href="#4-6-签名RPM" class="headerlink" title="4.6. 签名RPM"></a>4.6. 签名RPM</h3><p>为了防止RPM在分发的各个阶段被恶意篡改，需要对RPM包签名。</p><p>签名RPM包要求您创建一对公钥和私钥，使用私钥对您的RPM签名，</p><p>然后将公钥分发给客户端，以便客户端验证安装包的可靠性，以防止安装包被恶意篡改。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#创建 公钥私钥对 </span></span><br><span class="line"></span><br><span class="line">$ gpg --gen-key</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>生成公用/专用密钥时，大多数参数可以使用默认值。</p><p>输出结类似于以下形式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">pub 2048R/99A9CF07 2011-09-16</span><br><span class="line"></span><br><span class="line">Key fingerprint = 90BF B5DC 628E C9E0 88D0 E5D1 E828 4641 99A9 CF07</span><br><span class="line"></span><br><span class="line">uid Chris Negus (My own build of the tree package.)</span><br><span class="line"></span><br><span class="line">sub 2048R/48E60E56 2011-09-16</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>使用生成的密钥ID（在本例中为99A9CF07）将私钥导出为公钥:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#Export public key</span></span><br><span class="line"></span><br><span class="line">$ gpg -a -o RPM-GPG-KEY-ABC –-<span class="built_in">export</span> 99A9CF07</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>为了确保使用密钥ID对软件包进行签名，可以在.rpmmacros 文件添加如下_gpg_name参数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#Add _gpg_name keyID to your .rpmmacros file</span></span><br><span class="line"></span><br><span class="line">vi ~/.rpmmacros</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">%_gpg_name 99A9CF07</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>现在您可以给RPM包签名了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#Sign pkg</span></span><br><span class="line"></span><br><span class="line">$ rpm –-resign ~/rpmbuild/RPMS/x86_64/tree-1.5.3-2.el6.x86_64.rpm</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-7-在yum存储库中发布RPM"><a href="#4-7-在yum存储库中发布RPM" class="headerlink" title="4.7. 在yum存储库中发布RPM"></a>4.7. 在yum存储库中发布RPM</h3><p>发布RPM的一种方式是，在已有 Web服务器的基础桑创建yum存储库，并将RPM发布到yum存储库，以便各种客户端工具可以访问到RPM包。</p><p>下面假设系统中已经安装正在运行了Web服务器，以下步骤将演示如何创建一个yum存储库并发布RPM到此存储库。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$ sudo mkdir /var/www/html/abc</span><br><span class="line"></span><br><span class="line"><span class="comment">#Make the public key available</span></span><br><span class="line"></span><br><span class="line">$ sudo cp ~/RPM-GPG-KEY-ABC /var/www/html/abc/</span><br><span class="line"></span><br><span class="line">$ sudo cp ~/rpmbuild/RPMS/x86_84/tree-1.5.3-2.el6.x86_64.rpm /var/www/html/abc/</span><br><span class="line"></span><br><span class="line"><span class="comment">#Create the yum repository</span></span><br><span class="line"></span><br><span class="line">$ sudo createrepo /var/www/html/abc</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-8-创建存储库（-repo）文件"><a href="#4-8-创建存储库（-repo）文件" class="headerlink" title="4.8. 创建存储库（.repo）文件"></a>4.8. 创建存储库（.repo）文件</h3><p>创建一个.repo文件，该文件标识存储库的URL。</p><p>想要安装软件包的客户端将能够简单地将abc.repo文件复制到自己的文件中</p><p>RHEL系统的/etc/yum.repos.d目录将其启用。 替换what.example.com</p><p>使用您自己的Web服务器的FQDN：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="variable">$vim</span> abc.repo</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[abc-repo]</span><br><span class="line"></span><br><span class="line">name=My ABC yum repository</span><br><span class="line"></span><br><span class="line">baseurl=http://whatever.example.com/abc</span><br><span class="line"></span><br><span class="line">gpgkey= http://whatever.example.com/RPM-GPG-KEY-ABC</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">cp abc.repo /var/www/html/abc</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-9-准备客户端以安装RPM"><a href="#4-9-准备客户端以安装RPM" class="headerlink" title="4.9. 准备客户端以安装RPM"></a>4.9. 准备客户端以安装RPM</h3><p>要安装RPM，客户端只需简单地将abc.repo文件复制到/etc/yum.repos.d目录，然后使用yum命令从您的存储库安装任何软件包即可。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">sudo wget http://whatever.example.com/abc/abc.repo -O /etc/yum.repos.d/abc.repo</span><br><span class="line"></span><br><span class="line">sudo yum install tree</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>要在将来如果要更新RPM，您只需重建RPM，将最新版本复制到yum</p><p>存储库目录（本例中为/var/www/html/abc），然后重新运行createrepo命令。</p><p>客户下次将安装最新的RPM包或更新软件包。</p><h3 id="4-10-检查您的RPM包装"><a href="#4-10-检查您的RPM包装" class="headerlink" title="4.10. 检查您的RPM包装"></a>4.10. 检查您的RPM包装</h3><p>一旦完成RPM的构建，就可以使用rpm命令检查其内容并进行</p><p>确保签名是否正常工作。 您可以在任何Red Hat Enterprise Linux系统上执行此操作，只要您</p><p>可以获得包和公钥。</p><h4 id="4-10-1-首先导入用于签名软件包的密钥并检查签名"><a href="#4-10-1-首先导入用于签名软件包的密钥并检查签名" class="headerlink" title="4.10.1. 首先导入用于签名软件包的密钥并检查签名"></a>4.10.1. 首先导入用于签名软件包的密钥并检查签名</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Import key file</span></span><br><span class="line"></span><br><span class="line">$ sudo rpm --import ~/RPM-GPG-KEY-ABC</span><br><span class="line"></span><br><span class="line"><span class="comment"># Check signature</span></span><br><span class="line"></span><br><span class="line">$ rpm -K ~/rpmbuild/RPMS/x86_64/tree-1.5.3-2.el6.x86_64.rpm</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">~/rpmbuild/RPMS/x86_64/tree-1.5.3-2.el6.x86_64.rpm: sha1 md5 OK</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="4-10-2-接下来，检查文件的内容"><a href="#4-10-2-接下来，检查文件的内容" class="headerlink" title="4.10.2. 接下来，检查文件的内容"></a>4.10.2. 接下来，检查文件的内容</h4><p>这可以通过多种方式来实现。</p><p>选项 -q 查询</p><p>-p 从软件包查询包信息（如果不指定该参数，命令默认将从rpm数据库查询，而数据库中未安装此rpm包，可能得不到信息，或其他版本的信息）</p><p>-i 显示信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">rpm -qpi ~/rpmbuild/RPMS/x86_64/tree-1.5.3-2.el6.x86_64.rpm</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Name : tree Relocations: (not relocatable)</span><br><span class="line"></span><br><span class="line">Version : 1.5.3 Vendor: (none)</span><br><span class="line"></span><br><span class="line">Release : 2.el6 Build Date: Thu 15 Sep 2011 11:53:37 PM EDT</span><br><span class="line"></span><br><span class="line">Install Date: (not installed) Build Host: cnegus.linuxtoys.net</span><br><span class="line"></span><br><span class="line">Group : Applications/File Source RPM: tree-1.5.3-2.el6.src.rpm</span><br><span class="line"></span><br><span class="line">Size : 73868 License: GPLv2+</span><br><span class="line"></span><br><span class="line">Signature : (none)</span><br><span class="line"></span><br><span class="line">URL : http://mama.indstate.edu/users/ice/tree/</span><br><span class="line"></span><br><span class="line">Summary : File system tree viewer</span><br><span class="line"></span><br><span class="line">Description :</span><br><span class="line"></span><br><span class="line">The tree utility recursively displays the contents of directories in a</span><br><span class="line"></span><br><span class="line">tree-like format. Tree is basically a UNIX port of the DOS tree</span><br><span class="line"></span><br><span class="line">utility.</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>使用-l（小写L）选项，可以列出软件包的内容：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$ rpm -qpl ~/rpmbuild/RPMS/x86_64/tree-1.5.3-2.el6.x86_64.rpm</span><br><span class="line"></span><br><span class="line">/usr/bin/tree</span><br><span class="line"></span><br><span class="line">/usr/share/doc/tree-1.5.3</span><br><span class="line"></span><br><span class="line">/usr/share/doc/tree-1.5.3/LICENSE</span><br><span class="line"></span><br><span class="line">/usr/share/doc/tree-1.5.3/README</span><br><span class="line"></span><br><span class="line">/usr/share/man/man1/tree.1.gz</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>rpm命令还有许多其他选项用于检查和使用RPM软件包。 参考rpm手册页以获取详细信息（键入man rpm）。</p><h2 id="5-从零开始构建RPM"><a href="#5-从零开始构建RPM" class="headerlink" title="5. 从零开始构建RPM"></a>5. 从零开始构建RPM</h2><p>要创建自己的RPM，您需要创建自己的spec文件（并将其放在SPECS目录中），然后</p><p>将所需的可执行文件，脚本，用户文档文件和配置文件收集到压缩包中</p><p>包含在RPM中。 您可以通过简单地复制现有的规范文件并对其进行修改来创建规范文件。</p><p>或者您可以使用vim或emacs命令打开以.spec结尾的任何新文件。</p><p>编辑器将在新文件中自动创建一个模板以方便编写RPM spec文件。 那你可以</p><p>遵循本文档前面介绍的其余部分。</p><p>要查看RPM内容压缩包的示例，可以尝试使用tar解压缩tree安装包和源码包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$ tar xvf ~/rpmbuild/SOURCES/tree-1.5.3.tgz</span><br><span class="line"></span><br><span class="line">tree-1.5.3/CHANGES</span><br><span class="line"></span><br><span class="line">tree-1.5.3/INSTALL</span><br><span class="line"></span><br><span class="line">tree-1.5.3/LICENSE</span><br><span class="line"></span><br><span class="line">tree-1.5.3/Makefile</span><br><span class="line"></span><br><span class="line">tree-1.5.3/README</span><br><span class="line"></span><br><span class="line">tree-1.5.3/tree.c</span><br><span class="line"></span><br><span class="line">tree-1.5.3/strverscmp.c</span><br><span class="line"></span><br><span class="line">tree-1.5.3/man/tree.1</span><br><span class="line"></span><br><span class="line">tree-1.5.3/man/tree.1.fr</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>要创建自己的tarball，你可以简单的将内容放在 一个目录中（例如〜/ abc-1.0）并把包含在SOURCES的文件包装成一个tarball即可：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">tar -cvzf ~/rpmbuild/SOURCES/abc-1.0-1.tar.gz ~/abc-1.0/</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="6-获得更多关于RPMS的帮助"><a href="#6-获得更多关于RPMS的帮助" class="headerlink" title="6. 获得更多关于RPMS的帮助"></a>6. 获得更多关于RPMS的帮助</h2><p>构建RPM的能力远远超出本文档中的描述。 大多数复杂性来自构建</p><p>spec文件。 您可以定义依赖对其他应用或库文件的依赖关系，设置文件的类型和权限，并在安装或卸载软件包时运行脚本。</p><p>下面是一些可以寻找帮助的地方：</p><p>怎样创建RPM包 (Fedora Project)</p><p>已经为Fedora项目创建了数千个RPM软件包。 FedoraProject.org网站上有一个</p><p>与创建用于Red Hat Enterprise Linux的RPM相似的出色文档：</p><p><a target="_blank" rel="noopener" href="http://fedoraproject.org/wiki/How_to_create_an_RPM_package">http://fedoraproject.org/wiki/How_to_create_an_RPM_package</a></p><p>使用 RPM 打包软件</p><p>还可以在以下站点找到更多信息，以帮助您开始构建第一个RPM：</p><p><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/library/l-rpm1/">http://www.ibm.com/developerworks/library/l-rpm1/</a></p><h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/cnland/archive/2013/01/22/2871762.html">rpmbuild命令详解</a></p></div><footer class="post-footer"><div class="reward-container"><div>您的支持是我创作深度好文的源动力!</div><button>赞赏</button><div class="post-reward"><div><img src="/imgs/rewards/wechatpay.jpg" alt="鹏叔 微信"> <span>微信</span></div><div><img src="/imgs/rewards/alipay.jpg" alt="鹏叔 支付宝"> <span>支付宝</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"><strong>本文作者： </strong>鹏叔</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://www.pengtech.net/linux/how_to_create_rpm_package.html" title="如何制作RPM安装包">https://www.pengtech.net/linux/how_to_create_rpm_package.html</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" rel="noopener external nofollow" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="post-tags"><a href="/tags/linux/" rel="tag"><i class="fa fa-tag"></i> linux</a></div><div class="post-nav"><div class="post-nav-item"><a href="/git/how_to_configure_git_push.html" rel="prev" title="如何配置git push"><i class="fa fa-chevron-left"></i> 如何配置git push</a></div><div class="post-nav-item"><a href="/linux/create_rpm_repository_on_linux.html" rel="next" title="linux环境下创建rpm仓库">linux环境下创建rpm仓库 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments utterances-container"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">鹏叔</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span>站点总字数：</span> <span title="站点总字数">1.3m</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span>站点阅读时长 &asymp;</span> <span title="站点阅读时长">19:58</span></span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="powered-by">由 <a href="https://hexo.io/" rel="noopener external nofollow" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener external nofollow" target="_blank">NexT.Mist</a> 强力驱动</div><div class="addthis_inline_share_toolbox"><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-615fe625918d4f20" async></script></div></div></footer><script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script><script src="/js/third-party/search/local-search.js"></script><script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdn.jsdelivr.net/npm/mermaid@8.13.2/dist/mermaid.min.js","integrity":"sha256-UIQPVkGifpwMvDH5yGgORJ9sSTDq38zz6BGU6dNaKhM="}}</script><script src="/js/third-party/tags/mermaid.js"></script><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"guoapeng/guoapeng.github.io","issue_term":"pathname","theme":"github-light","cdn":"https://utteranc.es/client.js"}</script><script src="/js/third-party/comments/utterances.js"></script></body></html>