<!doctype html><html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta><title>gitlab安装升级及迁移 - 鹏叔的技术博客</title><link rel="preload" href="https://cdnjs.loli.net/ajax/libs/font-awesome/6.0.0/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://cdnjs.loli.net/ajax/libs/font-awesome/6.0.0/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin><link rel="manifest" href="/manifest.json"><meta name="application-name" content="鹏叔的技术博客"><meta name="msapplication-TileImage" content="/images/favicon-16x16-next.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="鹏叔的技术博客"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="1. gitlab简介 2. 安装环境介绍 3. gitlab 安装 4. 系统要求 4.1. 安装准备工作 4.2. 开始安装gitlab   5. gitlab升级 5.1. 升级前备份 5.2. 开启yum缓存 5.3. 开始升级   6. gitlab迁移 6.1. 备份数据 6.2. 在新服务器上安装gitlab 6.3. 还原备份   7. 如何彻底卸载gitlab? 7.1. 卸载"><meta property="og:type" content="blog"><meta property="og:title" content="鹏叔的技术博客"><meta property="og:url" content="https://pengtech.net/"><meta property="og:site_name" content="鹏叔的技术博客"><meta property="og:description" content="1. gitlab简介 2. 安装环境介绍 3. gitlab 安装 4. 系统要求 4.1. 安装准备工作 4.2. 开始安装gitlab   5. gitlab升级 5.1. 升级前备份 5.2. 开启yum缓存 5.3. 开始升级   6. gitlab迁移 6.1. 备份数据 6.2. 在新服务器上安装gitlab 6.3. 还原备份   7. 如何彻底卸载gitlab? 7.1. 卸载"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://pengtech.net/img/og_image.png"><meta property="article:published_time" content="2021-11-06T04:00:00.000Z"><meta property="article:modified_time" content="2024-08-06T10:05:40.438Z"><meta property="article:author" content="eagle"><meta property="article:tag" content="gitlab"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://pengtech.net/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://pengtech.net/gitlab/gitlab_installation_upgrade.html"},"headline":"gitlab安装升级及迁移","image":["https://pengtech.net/img/og_image.png"],"datePublished":"2021-11-06T04:00:00.000Z","dateModified":"2024-08-06T10:05:40.438Z","author":{"@type":"Person","name":"鹏叔"},"publisher":{"@type":"Organization","name":"鹏叔的技术博客","logo":{"@type":"ImageObject","url":{"text":"鹏叔的技术博客"}}},"description":"1. gitlab简介 2. 安装环境介绍 3. gitlab 安装 4. 系统要求 4.1. 安装准备工作 4.2. 开始安装gitlab   5. gitlab升级 5.1. 升级前备份 5.2. 开启yum缓存 5.3. 开始升级   6. gitlab迁移 6.1. 备份数据 6.2. 在新服务器上安装gitlab 6.3. 还原备份   7. 如何彻底卸载gitlab? 7.1. 卸载"}</script><link rel="canonical" href="https://pengtech.net/gitlab/gitlab_installation_upgrade.html"><link rel="alternate" href="/atom.xml" title="鹏叔的技术博客" type="application/atom+xml"><link rel="icon" href="/images/favicon-16x16-next.png"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/6.0.0/css/all.min.css"><link data-pjax rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/styles/atom-one-light.min.css"><link rel="stylesheet"><link data-pjax rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-ZZTM0Y954E" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-ZZTM0Y954E")</script><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.loli.net/ajax/libs/pace/1.2.4/pace.min.js"></script><meta name="follow.it-verification-code" content="FDYm0CxLRXUa9hVlR3zQ"><script>!function(){function e(){var e,t,a;location.hash&&(e="#"+CSS.escape(location.hash.substring(1)),t=document.querySelector(`.tabs a[href="${e}"]`))&&(a=t.parentElement.parentElement,Array.from(a.children).forEach(e=>e.classList.remove("is-active")),Array.from(a.querySelectorAll("a")).map(e=>document.getElementById(e.getAttribute("href").substring(1))).forEach(e=>e.classList.add("is-hidden")),t&&t.parentElement.classList.add("is-active"),a=document.querySelector(e))&&a.classList.remove("is-hidden")}e(),window.addEventListener("hashchange",e,!1)}()</script><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><script type="text/javascript" src="/js/imaegoo/night.js"></script><canvas id="universe"></canvas><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">鹏叔的技术博客</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/angular/">angular</a><a class="navbar-item" href="/material-design/">material-design</a><a class="navbar-item" href="/linux/">linux</a><a class="navbar-item" href="/gitlab/">gitlab</a><a class="navbar-item" href="/frontend/">frontend</a><a class="navbar-item" href="/backend/">backend</a><a class="navbar-item" href="/vscode/">vscode</a><a class="navbar-item" href="/hexo/">Hexo</a><a class="navbar-item" href="/golang/">golang</a><a class="navbar-item" href="/v2rayA/">v2rayA</a><a class="navbar-item" href="/archives/">Archives</a><a class="navbar-item" href="/categories/">Categories</a><a class="navbar-item" href="/tags/">Tags</a><a class="navbar-item" href="/tools/">工具</a><a class="navbar-item" href="/friends/">友链</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2021-11-06T04:00:00.000Z" title="2021/11/6 00:00:00">2021-11-06</time>发表</span><span class="level-item"><time datetime="2024-08-06T10:05:40.438Z" title="2024/8/6 06:05:40">2024-08-06</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/devops/">devops</a><span> / </span><a class="link-muted" href="/categories/devops/gitlab/">gitlab</a></span><span class="level-item">27 分钟读完 (大约4024个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">gitlab安装升级及迁移</h1><div class="content"><ul><li><a href="#1-gitlab%E7%AE%80%E4%BB%8B">1. gitlab简介</a></li><li><a href="#2-%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83%E4%BB%8B%E7%BB%8D">2. 安装环境介绍</a></li><li><a href="#3-gitlab-%E5%AE%89%E8%A3%85">3. gitlab 安装</a></li><li><a href="#4-%E7%B3%BB%E7%BB%9F%E8%A6%81%E6%B1%82">4. 系统要求</a><ul><li><a href="#41-%E5%AE%89%E8%A3%85%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C">4.1. 安装准备工作</a></li><li><a href="#42-%E5%BC%80%E5%A7%8B%E5%AE%89%E8%A3%85gitlab">4.2. 开始安装gitlab</a></li></ul></li><li><a href="#5-gitlab%E5%8D%87%E7%BA%A7">5. gitlab升级</a><ul><li><a href="#51-%E5%8D%87%E7%BA%A7%E5%89%8D%E5%A4%87%E4%BB%BD">5.1. 升级前备份</a></li><li><a href="#52-%E5%BC%80%E5%90%AFyum%E7%BC%93%E5%AD%98">5.2. 开启yum缓存</a></li><li><a href="#53-%E5%BC%80%E5%A7%8B%E5%8D%87%E7%BA%A7">5.3. 开始升级</a></li></ul></li><li><a href="#6-gitlab%E8%BF%81%E7%A7%BB">6. gitlab迁移</a><ul><li><a href="#61-%E5%A4%87%E4%BB%BD%E6%95%B0%E6%8D%AE">6.1. 备份数据</a></li><li><a href="#62-%E5%9C%A8%E6%96%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E5%AE%89%E8%A3%85gitlab">6.2. 在新服务器上安装gitlab</a></li><li><a href="#63-%E8%BF%98%E5%8E%9F%E5%A4%87%E4%BB%BD">6.3. 还原备份</a></li></ul></li><li><a href="#7-%E5%A6%82%E4%BD%95%E5%BD%BB%E5%BA%95%E5%8D%B8%E8%BD%BDgitlab">7. 如何彻底卸载gitlab?</a><ul><li><a href="#71-%E5%8D%B8%E8%BD%BD%E5%89%8D%E5%A4%87%E4%BB%BD">7.1. 卸载前备份</a></li><li><a href="#72-%E6%89%A7%E8%A1%8C%E5%8D%B8%E8%BD%BD">7.2. 执行卸载</a></li></ul></li><li><a href="#8-%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5">8. 问题排查</a></li><li><a href="#9-%E5%85%B3%E8%81%94%E9%98%85%E8%AF%BB">9. 关联阅读</a></li></ul><h2 id="1-gitlab简介"><a href="#1-gitlab简介" class="headerlink" title="1. gitlab简介"></a>1. gitlab简介</h2><p>GitLab 是一个用于仓库管理系统的开源项目，使用Git作为代码管理工具，并在此基础上搭建起来的Web服务。<br>GitLab是由GitLabInc.开发，使用MIT许可证的基于网络的Git仓库管理工具，且具有wiki和issue跟踪功能。使用Git作为代码管理工具，并在此基础上搭建起来的web服务。<br>GitLab由乌克兰程序员DmitriyZaporozhets和ValerySizov开发，它使用Ruby语言写成。后来，一些部分用Go语言重写。截止2018年5月，该公司约有290名团队成员，以及2000多名开源贡献者。GitLab被IBM，Sony，JülichResearchCenter，NASA，Alibaba，Invincea，O’ReillyMedia，Leibniz-Rechenzentrum(LRZ)，CERN，SpaceX等组织使用。</p><span id="more"></span><h2 id="2-安装环境介绍"><a href="#2-安装环境介绍" class="headerlink" title="2. 安装环境介绍"></a>2. 安装环境介绍</h2><p>服务器的操作系统为CentOS Linux release 7.9.2009<br>包管理工具yum.<br>这里安装的是gitlab企业版，本教程可以作为社区版安装的参考资料，社区版安装稍有不同，在了解社区版的差异后，安装步骤稍作调整．</p><h2 id="3-gitlab-安装"><a href="#3-gitlab-安装" class="headerlink" title="3. gitlab 安装"></a>3. gitlab 安装</h2><p>gitlab的安装方式有很多种，比如docker镜像安装，Helm charts安装，源代码安装，GET(GitLab Environment Toolkit)安装, 本文主要讲述使用ceontos或redhat系列中通过yum安装使用rpm包安装．安装前需要对yum和rpm命令有一定的了解．</p><h2 id="4-系统要求"><a href="#4-系统要求" class="headerlink" title="4. 系统要求"></a>4. 系统要求</h2><p>空闲硬盘空间：　2.5G+<br>CPU: 4core+ (4核最多支持500用户，8核最多支持1000用户)<br>内存：4GB+</p><h3 id="4-1-安装准备工作"><a href="#4-1-安装准备工作" class="headerlink" title="4.1. 安装准备工作"></a>4.1. 安装准备工作</h3><ul><li><p>更新yum源<br>这里采用南京大学镜像(主要处于下载速度考虑)，如果你访问外网的速度够快, 可以考虑使用官方镜像．<br>将下面一段代码拷贝到&#x2F;etc&#x2F;yum.repos.d, 命名为gitlab_gitlab-ee.repo, 当然你也可以根据自己的喜好命名，只要文件后缀为.repo即可，符合yum源文件命名规范即可</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[gitlab_gitlab-ee]</span></span><br><span class="line"> <span class="attr">name</span>=Gitlab EE Repository</span><br><span class="line"> <span class="attr">baseurl</span>=https://mirrors.nju.edu.cn/gitlab-ee/yum/el<span class="variable">$releasever</span>/</span><br><span class="line"> <span class="attr">gpgcheck</span>=<span class="number">0</span></span><br><span class="line"> <span class="attr">enabled</span>=<span class="number">1</span></span><br></pre></td></tr></table></figure></li><li><p>更新yum缓存，以便快速查询，确保缓存中有最新安装包信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum makecache</span><br></pre></td></tr></table></figure></li></ul><h3 id="4-2-开始安装gitlab"><a href="#4-2-开始安装gitlab" class="headerlink" title="4.2. 开始安装gitlab"></a>4.2. 开始安装gitlab</h3><ul><li><p>开始安装前可以使用yum命令查看有哪些可用的版本，以及当前最新版本是哪个．</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum list gitlab-ee --showduplicates | <span class="built_in">sort</span> -r</span><br></pre></td></tr></table></figure><blockquote><p>通过以上命令，确定当前列表中包含最新版本，如果列表中最新版本不是最新的，可能需要执行yum makecache 更新缓存，或者yum源本身就不包含最新版本，那么要考虑更换yum源．如果要安装指定版本，需要确保需要安装的版本包含在列表中．</p></blockquote></li><li><p>安装最新版本的方法</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y gitlab-ee</span><br></pre></td></tr></table></figure></li><li><p>安装特定版本的方法<br>以centos7为例, 后面的版本号x.y.z-ee.0.el7根据实际情况进行替换．</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y gitlab-ee-x.y.z-ee.0.el7</span><br></pre></td></tr></table></figure></li><li><p>配置gitlab<br>安装完成后执行以下命令gitlab将会自动帮我们完成一些必要的配置，切记如果你手动完成一些配置后不要重复执行以下命令，否则手动配置的参数会被清除，严重时会导致用户访问时出现http 500错误．</p><p>修改external_url<br>编辑文件&#x2F;etc&#x2F;gitlab&#x2F;gitlab.rb</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#replace gitlab.example.com with your domain or your ip</span></span><br><span class="line"><span class="comment"># for instance external_url &#x27;http://192.168.1.100&#x27;</span></span><br><span class="line">external_url <span class="string">&#x27;your_domain&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl reconfigure</span><br></pre></td></tr></table></figure></li><li><p>启动gitlab</p><p>gitlab默认运行在80端口<br>需要检查防火墙状态, 如何防火墙已开启, 需要放行80端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查防火墙是否开启</span></span><br><span class="line"><span class="built_in">sudo</span> firewall-cmd --state</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果开启, 需放行80端口</span></span><br><span class="line"><span class="built_in">sudo</span> firewall-cmd --add-port=80/tcp --permanent</span><br><span class="line"><span class="built_in">sudo</span> firewall-cmd --reload</span><br></pre></td></tr></table></figure><p>如果一切顺利，我们就可以启动gitlab了，启动命令为</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl start</span><br></pre></td></tr></table></figure><p>启动成功后, 可以使用浏览器访问gitlab web页面，默认端口是80, 所以可以打开<a target="_blank" rel="noopener" href="http://your_server_address/">http://your_server_address</a>访问．</p><p>如果没有设置密码，系统将为root用户生成一个随机密码，该随机密码可以在&#x2F;etc&#x2F;gitlab&#x2F;initial_root_password文件中找到．<br>建议修改该随机密码，方式为</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-rake <span class="string">&quot;gitlab:password:reset[root]&quot;</span></span><br></pre></td></tr></table></figure><blockquote><p>参数说明: 命令中的root即为root用户，该命令也可以用来为其他用户设置密码．</p><p>关于gitlab的高级配置，可以参考<a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/install/">gitlab的官网</a></p><p>如果要配置gitlab ci&#x2F;cd还需要安装gitlab-runner, gitlab-runner的安装和配置可以参考我的博客<a href="https://pengtech.net/gitlab/gitlab_runner_installation.html">gitlab-runner安装与配置</a>, 更多关于gitlab的文章请访问<a href="https://pengtech.net/gitlab/">gitlab合集</a></p></blockquote><p>这里补充几点如何启动，关闭，查看gitlab状态的命令，方便troubleshooting<br>关闭gitlab</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl stop</span><br></pre></td></tr></table></figure><p>重启gitlab</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl restart</span><br></pre></td></tr></table></figure><p>查看gitlab状态</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl status</span><br></pre></td></tr></table></figure><p>查看gitlab滚动日志</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl <span class="built_in">tail</span></span><br></pre></td></tr></table></figure><p>想了解更多命令，可以查看帮助</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl --<span class="built_in">help</span></span><br></pre></td></tr></table></figure><p>命令行查看gitlab版本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /opt/gitlab/embedded/service/gitlab-rails/VERSION</span><br></pre></td></tr></table></figure><p>查看日志文件</p><p>日志文件位于&#x2F;var&#x2F;log&#x2F;gitlab下, 日志是按照服务分类存放</p><p>Gitlab 日志文件位于 &#x2F;var&#x2F;log&#x2F;gitlab&#x2F;gitlab-rails&#x2F;production.log</p></li></ul><h2 id="5-gitlab升级"><a href="#5-gitlab升级" class="headerlink" title="5. gitlab升级"></a>5. gitlab升级</h2><p>Gitlab的更新速度还是挺快的, 每隔一个月就会发布一个release. 如果要使用一些新特性或修补一些安全漏洞, 掌握升级技巧是必不可少的. 这里个人建议收藏文档, 原文在文章末尾有链接地址, 以备升级时使用, 知道系统是如何安装的, 又该如何升级. 原文实时更新, 踩过的坑都会记录下来.</p><p>更多关于Gitlab的release政策, 请参考gitlab官方文档<a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/policy/maintenance.html">GitLab release and maintenance policy</a></p><h3 id="5-1-升级前备份"><a href="#5-1-升级前备份" class="headerlink" title="5.1. 升级前备份"></a>5.1. 升级前备份</h3><ul><li>备份数据</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-rake gitlab:backup:create</span><br></pre></td></tr></table></figure><ul><li>备份敏感数据</li></ul><p>手动备份两个具有敏感数据的文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span>  /etc/gitlab/gitlab.rb  /var/opt/gitlab/backups</span><br><span class="line"><span class="comment"># and</span></span><br><span class="line"><span class="built_in">cp</span>  /etc/gitlab/gitlab-secrets.json  /var/opt/gitlab/backups</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>说明：</p><ul><li>备份被保存在&#x2F;var&#x2F;opt&#x2F;gitlab&#x2F;backups目录下</li><li>备份文件名格式如下: 例如1665044212_2022_10_06_14.4.1-ee_gitlab_backup.tar, 命名规则为:备份编号+日期+gitlab版本号+后缀</li><li>备份恢复的原则是对应版本的备份文件只能使用对应版本的gitlab程序进行恢复</li><li>跨版本恢复备份文件会出现恢复失败或未知错误</li><li>如果要在高版本中使用低版本的备份文件<ul><li>方法一: 在另一台机中 安装低版本gitlab 将低版本的备份程序采用低版本的gitlab恢复后再将低版本的gitlab升级到高版本, 再使用高版本的gitlab制作备份文件</li></ul></li></ul></blockquote><h3 id="5-2-开启yum缓存"><a href="#5-2-开启yum缓存" class="headerlink" title="5.2. 开启yum缓存"></a>5.2. 开启yum缓存</h3><ul><li><p>gitlab的每个安装包都接近1G大小，gitlab升级过程中可能需要反复恢复重试，如果不开启yum缓存，即每次执行yum install无论成功与否，安装包都会被清理掉，下次重试即使是相同的版本也会去服务器上重新下载，会特别慢，而且消耗服务器带宽，如果触发了镜像服务器的限流机制，升级可能会无法进行下去.</p></li><li><p>强烈建议开启yum缓存，等升级完成后再关闭缓存并手动清理 &#x2F;var&#x2F;cache&#x2F;yum&#x2F;x86_64&#x2F;7&#x2F;gitlab_gitlab-ee下的缓存．</p></li><li><p>开启yum 缓存步骤如下: 修改&#x2F;etc&#x2F;yum.conf, 将keepcache设置为1, 默认为0.<br>这样当再次重试相同版本时就可以使用-C 参数使用缓存(详细使用方法参考”开始升级章节”)，而不必去镜像服务器上重新下载．</p></li></ul><p>&#x2F;etc&#x2F;yum.conf</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="section">[main]</span></span><br><span class="line"><span class="attr">cachedir</span>=/var/cache/yum/<span class="variable">$basearch</span>/<span class="variable">$releasever</span></span><br><span class="line"><span class="attr">keepcache</span>=<span class="number">1</span>　<span class="comment"># 开启缓存, 1表示开启缓存, 0表示关闭缓存</span></span><br><span class="line"><span class="attr">debuglevel</span>=<span class="number">2</span></span><br><span class="line"><span class="attr">logfile</span>=/var/log/yum.log</span><br><span class="line"><span class="attr">exactarch</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">obsoletes</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">plugins</span>=<span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="5-3-开始升级"><a href="#5-3-开始升级" class="headerlink" title="5.3. 开始升级"></a>5.3. 开始升级</h3><ul><li><p>升级前需要了解升级路径，gitlab不能一次性从低版本升级到最新版，需要升级到必要的中间版本，然后一步步升级到最新版本．主要涉及到版本之间的数据的迁移(data migration)工作，所以必须经过其中关键的版本升级，才能顺利完成数据更新操作．<br>升级路径可以参考<a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/update/">官网</a> - <a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/update/#upgrade-paths">Upgrade paths</a>, 这里简要列举路径如下<br>8.11.Z -&gt; 8.12.0 -&gt; 8.17.7 -&gt; 9.0.13 -&gt; 9.5.10 -&gt; 10.0.7 -&gt; 10.8.7-&gt; 11.0.6 -&gt; 11.11.8 -&gt; 12.0.12 -&gt; 12.1.17 -&gt; 12.10.14 -&gt; 13.0.14 -&gt; 13.1.11 -&gt; 13.8.8 -&gt; 13.12.15 -&gt; 14.0.12 -&gt; 14.3.6 -&gt; 14.9.5 -&gt; 14.10.5 -&gt; 15.0.5 -&gt; 15.1.6 (for GitLab instances with multiple web nodes) -&gt; 15.4.6 -&gt; 15.11.13 -&gt;<br>(only instances with lots of users or large pipeline variables history) &gt; 16.1 (instances with NPM packages in their package registry) &gt; 16.2.x (only instances with large pipeline variables history) &gt; 16.3 &gt; latest 16.Y.Z.</p></li><li><p>首先确定gitlab版本信息, 然后再选择合适的升级路径</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">gitlab-rake gitlab:<span class="built_in">env</span>:info</span><br><span class="line"></span><br><span class="line"><span class="comment"># 例如</span></span><br><span class="line">GitLab information</span><br><span class="line">Version:        14.4.1-ee</span><br><span class="line">Revision:       abc23a14bac</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><p>gitlab-rake中Rake并不是单词<a target="_blank" rel="noopener" href="https://philoenglish.com/query/rake">Rake</a>的意思, 它实际上是Ruby Make的简写形式, 是ruby种类似make的一种程序. 使用Rake可以做一些通用的管理和运维任务.</p><ul><li><p>升级前关闭gitlab的部分服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line">gitlab-ctl stop unicorn</span><br><span class="line">gitlab-ctl stop sidekiq</span><br><span class="line">gitlab-ctl stop nginx</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>升级命令</p><p>升级命令和安装命令是一样的, 将x.y.z-ee.0.el7替换成关键中间版本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum update -y -C gitlab-ee-x.y.z-ee.0.el7</span><br></pre></td></tr></table></figure><blockquote><p>-C 参数使用缓存, 详细解释参考”开启yum缓存”</p></blockquote><p>升级完成后，<br>需要重新运行配置,否则启动会失败</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl reconfigure</span><br></pre></td></tr></table></figure><p>如果有手动配置，需要重做一遍．</p><p>需要启动gitlab,等待数据迁移任务完成，然后再备份，再次进行下一个版本的升级．</p><p>如果遇到严重问题，需要回退到上一个版本，导入备份，解决问题后继续往后升级，所以备份数据很重要．</p><p>备份恢复命令如下：<br>其中636041545_2021_11_04_12.10.14为备份文件的名字，不包含文件名后缀．</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-rake gitlab:backup:restore BACKUP=1636041545_2021_11_04_12.10.14</span><br></pre></td></tr></table></figure></li><li><p>每个版本升级完成后，要启动gitlab等待数据迁移完成<br>查看数据迁移任务，有两种查看方式，可以通过web界面查看，也可以通过命令行来查看．</p><ul><li><p>web界面查看方式<br>查看迁移任务的状态，打开web界面:<br>在页面顶部, 选择 Menu &gt; Admin.<br>在页面左侧边栏，选择Monitoring &gt; Background Migrations.</p></li><li><p>命令行查看方式</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-rails runner -e production <span class="string">&#x27;puts Gitlab::BackgroundMigration.remaining&#x27;</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><h2 id="6-gitlab迁移"><a href="#6-gitlab迁移" class="headerlink" title="6. gitlab迁移"></a>6. gitlab迁移</h2><ul><li><p>有时我们需要将gitlab迁移到新的性能更好的服务器．怎么进行迁移呢？当然方法很多，这里介绍其中的一种方式，即通过先备份，然后在新的服务器上进行还原操作．</p></li><li><p>说明: gitlab还原有一点需要注意，那就是备份文件只能是在与创建备份的gitlab版本相同的gitlab上才能恢复，备份文件的后八位即是创建该备份的gitlab的版本，该版本只能在这种版本下进行还原．</p></li></ul><h3 id="6-1-备份数据"><a href="#6-1-备份数据" class="headerlink" title="6.1. 备份数据"></a>6.1. 备份数据</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-rake gitlab:backup:create</span><br></pre></td></tr></table></figure><ul><li>备份文件默认(如果没有修改默认配置的情况下)保存在&#x2F;var&#x2F;opt&#x2F;gitlab&#x2F;backups目录下面．</li></ul><h3 id="6-2-在新服务器上安装gitlab"><a href="#6-2-在新服务器上安装gitlab" class="headerlink" title="6.2. 在新服务器上安装gitlab"></a>6.2. 在新服务器上安装gitlab</h3><ul><li>可以参考本文的安装部分进行安装</li></ul><h3 id="6-3-还原备份"><a href="#6-3-还原备份" class="headerlink" title="6.3. 还原备份"></a>6.3. 还原备份</h3><ul><li><p>将备份文件拷贝到新服务器的&#x2F;var&#x2F;opt&#x2F;gitlab&#x2F;backups目录下，执行恢复命令．备份文件参数，根据自己的实际情况进行修改．</p><p>首先要将旧服务器上的两个文件<code>/etc/gitlab/gitlab.rb</code>,<code>/etc/gitlab/gitlab-secrets.json</code>拷贝到新服务器, 否则后续会发现一些奇怪的问题.</p><p>并将&#x2F;etc&#x2F;gitlab&#x2F;gitlab.rb 的external_url设置为正确的url</p><p>然后执行<code>gitlab-ctl reconfigure</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-rake gitlab:backup:restore BACKUP=1636041545_2021_11_04_12.10.14</span><br></pre></td></tr></table></figure><p>如果还原失败, 请先参考问题排查章节, 再在到网上查找解决办法.</p></li></ul><h2 id="7-如何彻底卸载gitlab"><a href="#7-如何彻底卸载gitlab" class="headerlink" title="7. 如何彻底卸载gitlab?"></a>7. 如何彻底卸载gitlab?</h2><ul><li>警告: 注意标题上彻底二字，在你不清楚卸载意味着会发生什么的时候，请不要执行以下任何步骤．</li></ul><h3 id="7-1-卸载前备份"><a href="#7-1-卸载前备份" class="headerlink" title="7.1. 卸载前备份"></a>7.1. 卸载前备份</h3><ul><li><p>卸载前执行一次备份，备份存放位置为&#x2F;var&#x2F;opt&#x2F;gitlab&#x2F;backups, 因为后续该目录也会被清除，所以请将备份拷贝到一个安全的位置，因为后续动作可能会永久的删除数据，以便后续发生问题或反悔的时候，可以从备份恢复数据．</p></li><li><p>备份数据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-rake gitlab:backup:create</span><br></pre></td></tr></table></figure></li><li><p>备份敏感数据</p><p>手动备份两个具有敏感数据的文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span>  /etc/gitlab/gitlab.rb  /var/opt/gitlab/backups</span><br><span class="line"><span class="comment"># and</span></span><br><span class="line"><span class="built_in">cp</span>  /etc/gitlab/gitlab-secrets.json  /var/opt/gitlab/backups</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h3 id="7-2-执行卸载"><a href="#7-2-执行卸载" class="headerlink" title="7.2. 执行卸载"></a>7.2. 执行卸载</h3><ul><li><p>关闭gitlab</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#关闭gtilab</span></span><br><span class="line">gitlab-ctl stop</span><br><span class="line"><span class="comment">#查看gitlab状态，确保已经关闭</span></span><br><span class="line">gitlab-ctl status</span><br></pre></td></tr></table></figure></li><li><p>卸载应用程序</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -e gitlab-ee</span><br></pre></td></tr></table></figure></li><li><p>删除数据残留<br>首先确认有哪些数据残留</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -name gitlab</span><br></pre></td></tr></table></figure><p>如果都是期望被删除的，那么开始执行删除操作，再次提醒将备份拷贝一份到安全位置．</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 首先使用find命令查看一下有哪些数据残留</span></span><br><span class="line">find / -name gitlab </span><br><span class="line"><span class="comment"># 确定以上文件可以删除后使用删除命令进行删除</span></span><br><span class="line">find / -name gitlab | xargs <span class="built_in">rm</span> -rf</span><br></pre></td></tr></table></figure></li></ul><h2 id="8-问题排查"><a href="#8-问题排查" class="headerlink" title="8. 问题排查"></a>8. 问题排查</h2><ul><li><p>问题 1:</p><p>从一台机迁移到另外一台机时报如下错错误</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Restoring PostgreSQL database gitlabhq_production ... ERROR:  must be owner of extension pg_trgm</span><br><span class="line">ERROR:  must be owner of extension btree_gist</span><br><span class="line">ERROR:  must be owner of extension btree_gist</span><br><span class="line">ERROR:  must be owner of extension pg_trgm</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>解决办法:</p><p>修改postgresql配置, 能从本地连接到postgresql</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ vim /var/opt/gitlab/postgresql/data/postgresql.conf</span><br><span class="line">listen_addresses = <span class="string">&#x27;*&#x27;</span></span><br><span class="line"><span class="comment"># 最下面新增两行</span></span><br><span class="line">$ vim /var/opt/gitlab/postgresql/data/pg_hba.conf</span><br><span class="line"><span class="built_in">local</span>   all         all                               trust</span><br><span class="line">host    all         all                               127.0.0.1/32 trust</span><br></pre></td></tr></table></figure><p>重启gitlab使得配置生效</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">gitlab-ctl restart</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>修改gitlab账号为超级用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ su - gitlab-psql</span><br><span class="line">$ /opt/gitlab/embedded/bin/psql -h 127.0.0.1 gitlabhq_production</span><br><span class="line">psql (9.2.8)</span><br><span class="line">Type <span class="string">&quot;help&quot;</span> <span class="keyword">for</span> <span class="built_in">help</span>.</span><br><span class="line"></span><br><span class="line">gitlabhq_production=# ALTER USER gitlab WITH SUPERUSER;</span><br><span class="line">ALTER ROLE</span><br><span class="line">gitlabhq_production=# \q</span><br></pre></td></tr></table></figure><p>修改完gitlab用户权限后, 记得将postgresql的配置文件改回去</p><ol><li>保证安全性, 防止误操作</li><li>以免后续安装postgresql数据库是参数端口冲突</li></ol><p>参考文档: <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/09a2b0c25ecd">https://www.jianshu.com/p/09a2b0c25ecd</a></p></li><li><p>问题 2:</p><p>解决Gitlab迁移后，项目的 CI&#x2F; CD页面报500错误</p><p>原因是: gitlab默认的备份机制，是不会备份gitlab.rb和gitlab-secrets.json文件的,<br>如果这两文件还存在则将其拷贝到新的服务器, 如果不存在则将secrets 清除重设<br>参考: <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c46aa8c8539c">https://www.jianshu.com/p/c46aa8c8539c</a></p></li></ul><h2 id="9-关联阅读"><a href="#9-关联阅读" class="headerlink" title="9. 关联阅读"></a>9. 关联阅读</h2><p><a href="https://pengtech.net/gitlab/gitlab_installation_upgrade.html">gitlab安装升级及迁移</a></p><p><a href="https://pengtech.net/gitlab/gitlab_issue_board.html">使用gitlab issue board的四种方式</a></p><p><a href="https://pengtech.net/gitlab/gitlab_plantuml_integration.html">GitLab集成PlantUML</a></p><p><a href="https://pengtech.net/gitlab/gitlab_runner_installation.html">gitlab-runner安装与配置</a></p><p><a href="https://pengtech.net/gitlab/gitlab_runner_on_fedora.html">fedora上安装gitlab-runner安装与配置</a></p><p><a href="https://pengtech.net/gitlab/gitlab_runner_on_macos.html">macOS上安装gitlab-runner安装与配置</a></p><p><a href="https://pengtech.net/gitlab/gitlab_runner_on_ubuntu.html">ubuntu上安装gitlab-runner安装与配置</a></p><p><a href="https://pengtech.net/gitlab/gitlab_runner_on_windows.html">windows上安装gitlab-runner</a></p><p><a href="https://pengtech.net/gitlab/gitlab_runner_on_windows.html">gitlab CICD基础</a></p></div><div class="card"><div class="card-content" style="padding-left:0;font-size:1.1rem"><h2 style="font-size:1.5rem;margin-bottom:.5rem">相关文章</h2><span><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="/gitlab/gitlab-runner_cli.html" title="gitlab-runner常用命令" rel="bookmark">gitlab-runner常用命令</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="/gitlab/gitlab-cicd-basic.html" title="gitlab CICD基础" rel="bookmark">gitlab CICD基础</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="/gitlab/gitlab_ee_crack.html" title="破解Gitlab ee 15 企业版" rel="bookmark">破解Gitlab ee 15 企业版</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="/gitlab/gitlab_issue_board.html" title="使用gitlab issue board的四种方式" rel="bookmark">使用gitlab issue board的四种方式</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="/gitlab/gitlab_plantuml_integration.html" title="GitLab集成PlantUML" rel="bookmark">GitLab集成PlantUML</a></h3></div></li></ul></span></div></div><div class="article-licensing box"><div class="licensing-title"><p>gitlab安装升级及迁移</p><p><a href="https://pengtech.net/gitlab/gitlab_installation_upgrade.html">https://pengtech.net/gitlab/gitlab_installation_upgrade.html</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>鹏叔</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-11-06</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2024-08-06</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/gitlab/">gitlab</a></div></article></div><div class="card"><nav class="post-navigation mt-4 level is-mobile card-content"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/linux/linux-expect-explanation.html"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Linux expect 详解</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/gitlab/gitlab_runner_installation.html"><span class="level-item">gitlab-runner安装与配置</span><i class="level-item fas fa-chevron-right"></i></a></div></nav></div><div class="card" id="comments"><div class="card-content"><span class="title is-5">评论</span><script src="https://utteranc.es/client.js" repo="guoapeng/guoapeng.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="鹏叔的技术博客"></figure><p class="title is-size-4 is-block" style="line-height:inherit">鹏叔的技术博客</p><p class="is-size-6 is-block">日拱一卒，功不唐捐!</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Earth, Solar System, Galaxy.</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives/"><p class="title">277</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories/"><p class="title">52</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags/"><p class="title">94</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/guoapeng" target="_blank" rel="me noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/guoapeng"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Mail" href="mailto:guoapeng@gmail.com"><i class="fas fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="https://api.follow.it/subscription-form/WmRzSTRLOENhYXVqeVBHRTVyT2wrR0hrdDhDL0JIWDBBNmovOUJXRE1oZExjV1haM0c3cGxHNlhBV3NvQkFOVC9INHF6aGZlUGpwTzcrTGFDRnZEL3NQck9IYzFiYkxiTVVTb2hnL1VaVmJKY09VTHVpbnVBYjJEVXQwNGZMN3R8cWhjVW1qVStTNlBWWGpMM1UydWpHOUNMcGUzbS9PcHgrZEI1UWpqckZYRT0=/8" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">友情链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://philoenglish.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">菲利英语</span></span><span class="level-right"><span class="level-item tag">philoenglish.com</span></span></a></li><li><a class="level is-mobile" href="https://ngrevive.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Angular复兴</span></span><span class="level-right"><span class="level-item tag">ngrevive.com</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AI/"><span class="level-start"><span class="level-item">AI</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/IM/"><span class="level-start"><span class="level-item">IM</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/OS/"><span class="level-start"><span class="level-item">OS</span></span><span class="level-end"><span class="level-item tag">48</span></span></a><ul><li><a class="level is-mobile" href="/categories/OS/android/"><span class="level-start"><span class="level-item">android</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/OS/linux/"><span class="level-start"><span class="level-item">linux</span></span><span class="level-end"><span class="level-item tag">40</span></span></a></li><li><a class="level is-mobile" href="/categories/OS/windows/"><span class="level-start"><span class="level-item">windows</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/backend/"><span class="level-start"><span class="level-item">backend</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/database/"><span class="level-start"><span class="level-item">database</span></span><span class="level-end"><span class="level-item tag">10</span></span></a><ul><li><a class="level is-mobile" href="/categories/database/mariadb/"><span class="level-start"><span class="level-item">mariadb</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/database/postgresql/"><span class="level-start"><span class="level-item">postgresql</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/devops/"><span class="level-start"><span class="level-item">devops</span></span><span class="level-end"><span class="level-item tag">25</span></span></a><ul><li><a class="level is-mobile" href="/categories/devops/ansible/"><span class="level-start"><span class="level-item">ansible</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/devops/build-tools/"><span class="level-start"><span class="level-item">build tools</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/devops/docker/"><span class="level-start"><span class="level-item">docker</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/devops/gitlab/"><span class="level-start"><span class="level-item">gitlab</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/devops/k8s/"><span class="level-start"><span class="level-item">k8s</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/language/"><span class="level-start"><span class="level-item">language</span></span><span class="level-end"><span class="level-item tag">19</span></span></a><ul><li><a class="level is-mobile" href="/categories/language/golang/"><span class="level-start"><span class="level-item">golang</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/language/java/"><span class="level-start"><span class="level-item">java</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/language/rust/"><span class="level-start"><span class="level-item">rust</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/language/typescript/"><span class="level-start"><span class="level-item">typescript</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/network/"><span class="level-start"><span class="level-item">network</span></span><span class="level-end"><span class="level-item tag">8</span></span></a><ul><li><a class="level is-mobile" href="/categories/network/dns/"><span class="level-start"><span class="level-item">dns</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/network/frp/"><span class="level-start"><span class="level-item">frp</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/network/v2ray/"><span class="level-start"><span class="level-item">v2ray</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/network/vpn/"><span class="level-start"><span class="level-item">vpn</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/others/"><span class="level-start"><span class="level-item">others</span></span><span class="level-end"><span class="level-item tag">7</span></span></a><ul><li><a class="level is-mobile" href="/categories/others/English/"><span class="level-start"><span class="level-item">English</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/others/marketing/"><span class="level-start"><span class="level-item">marketing</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/others/movies/"><span class="level-start"><span class="level-item">movies</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/tools/"><span class="level-start"><span class="level-item">tools</span></span><span class="level-end"><span class="level-item tag">19</span></span></a><ul><li><a class="level is-mobile" href="/categories/tools/Astro/"><span class="level-start"><span class="level-item">Astro</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/tools/git/"><span class="level-start"><span class="level-item">git</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/tools/hexo/"><span class="level-start"><span class="level-item">hexo</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/tools/maven/"><span class="level-start"><span class="level-item">maven</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/tools/vscode/"><span class="level-start"><span class="level-item">vscode</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/web/"><span class="level-start"><span class="level-item">web</span></span><span class="level-end"><span class="level-item tag">135</span></span></a><ul><li><a class="level is-mobile" href="/categories/web/CMS/"><span class="level-start"><span class="level-item">CMS</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/web/SEO/"><span class="level-start"><span class="level-item">SEO</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/web/angular/"><span class="level-start"><span class="level-item">angular</span></span><span class="level-end"><span class="level-item tag">61</span></span></a></li><li><a class="level is-mobile" href="/categories/web/angularjs/"><span class="level-start"><span class="level-item">angularjs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/web/browser/"><span class="level-start"><span class="level-item">browser</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/web/build-tools/"><span class="level-start"><span class="level-item">build tools</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/web/components/"><span class="level-start"><span class="level-item">components</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/web/css/"><span class="level-start"><span class="level-item">css</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/web/design/"><span class="level-start"><span class="level-item">design</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/web/html/"><span class="level-start"><span class="level-item">html</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/web/javascript/"><span class="level-start"><span class="level-item">javascript</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/web/material-design/"><span class="level-start"><span class="level-item">material design</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/categories/web/nodejs/"><span class="level-start"><span class="level-item">nodejs</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/web/others/"><span class="level-start"><span class="level-item">others</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/web/tauri/"><span class="level-start"><span class="level-item">tauri</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li></ul></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/AI/"><span class="tag">AI</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Almalinux/"><span class="tag">Almalinux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Android/"><span class="tag">Android</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Angular/"><span class="tag">Angular</span><span class="tag">68</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ansible/"><span class="tag">Ansible</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Astro/"><span class="tag">Astro</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CMS/"><span class="tag">CMS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Comments/"><span class="tag">Comments</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/English/"><span class="tag">English</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Fedora/"><span class="tag">Fedora</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GORM/"><span class="tag">GORM</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Gemini-AI/"><span class="tag">Gemini AI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Giscus/"><span class="tag">Giscus</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Golang/"><span class="tag">Golang</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Helm/"><span class="tag">Helm</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hexo/"><span class="tag">Hexo</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/IDEA/"><span class="tag">IDEA</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java/"><span class="tag">Java</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Macos/"><span class="tag">Macos</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MariaDB/"><span class="tag">MariaDB</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Material/"><span class="tag">Material</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Matrix/"><span class="tag">Matrix</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NAS/"><span class="tag">NAS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NPM/"><span class="tag">NPM</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Nodejs/"><span class="tag">Nodejs</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OS/"><span class="tag">OS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Redhat/"><span class="tag">Redhat</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Rust/"><span class="tag">Rust</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SEO/"><span class="tag">SEO</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Seo/"><span class="tag">Seo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ubuntu/"><span class="tag">Ubuntu</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Vultr/"><span class="tag">Vultr</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows/"><span class="tag">Windows</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/angularjs/"><span class="tag">angularjs</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/backend/"><span class="tag">backend</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/blog/"><span class="tag">blog</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bootstrap/"><span class="tag">bootstrap</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/browser/"><span class="tag">browser</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/chartjs/"><span class="tag">chartjs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/chrome/"><span class="tag">chrome</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/database/"><span class="tag">database</span><span class="tag">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/design/"><span class="tag">design</span><span class="tag">16</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/element-web/"><span class="tag">element-web</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/fedora/"><span class="tag">fedora</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/firefox/"><span class="tag">firefox</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gitlab/"><span class="tag">gitlab</span><span class="tag">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/golang/"><span class="tag">golang</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gradle/"><span class="tag">gradle</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/html/"><span class="tag">html</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java/"><span class="tag">java</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript/"><span class="tag">javascript</span><span class="tag">63</span></a></div><div class="control"><a class="tags has-addons" href="/tags/k8s/"><span class="tag">k8s</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/less/"><span class="tag">less</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/life/"><span class="tag">life</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag">53</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/marketing/"><span class="tag">marketing</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/material-design/"><span class="tag">material design</span><span class="tag">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/maven/"><span class="tag">maven</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/network/"><span class="tag">network</span><span class="tag">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nginx/"><span class="tag">nginx</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pagination/"><span class="tag">pagination</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pgadmin/"><span class="tag">pgadmin</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pnpm/"><span class="tag">pnpm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/product/"><span class="tag">product</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sass/"><span class="tag">sass</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sentry/"><span class="tag">sentry</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/shell/"><span class="tag">shell</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/source-control/"><span class="tag">source_control</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spring/"><span class="tag">spring</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spring-boot/"><span class="tag">spring boot</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/springboot/"><span class="tag">springboot</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/strapi/"><span class="tag">strapi</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swagger/"><span class="tag">swagger</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tailwindcss/"><span class="tag">tailwindcss</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tauri/"><span class="tag">tauri</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tmux/"><span class="tag">tmux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/typescript/"><span class="tag">typescript</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/v2ray/"><span class="tag">v2ray</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/v2rayA/"><span class="tag">v2rayA</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/v2rayN/"><span class="tag">v2rayN</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/v2rayNG/"><span class="tag">v2rayNG</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/virualbox/"><span class="tag">virualbox</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vmware/"><span class="tag">vmware</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vscode/"><span class="tag">vscode</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag">61</span></a></div><div class="control"><a class="tags has-addons" href="/tags/webpack/"><span class="tag">webpack</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/websocket/"><span class="tag">websocket</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/windows/"><span class="tag">windows</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/wordpress/"><span class="tag">wordpress</span><span class="tag">2</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#1-gitlab简介"><span class="level-left"><span class="level-item">1. gitlab简介</span></span></a></li><li><a class="level is-mobile" href="#2-安装环境介绍"><span class="level-left"><span class="level-item">2. 安装环境介绍</span></span></a></li><li><a class="level is-mobile" href="#3-gitlab-安装"><span class="level-left"><span class="level-item">3. gitlab 安装</span></span></a></li><li><a class="level is-mobile" href="#4-系统要求"><span class="level-left"><span class="level-item">4. 系统要求</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-1-安装准备工作"><span class="level-left"><span class="level-item">4.1. 安装准备工作</span></span></a></li><li><a class="level is-mobile" href="#4-2-开始安装gitlab"><span class="level-left"><span class="level-item">4.2. 开始安装gitlab</span></span></a></li></ul></li><li><a class="level is-mobile" href="#5-gitlab升级"><span class="level-left"><span class="level-item">5. gitlab升级</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#5-1-升级前备份"><span class="level-left"><span class="level-item">5.1. 升级前备份</span></span></a></li><li><a class="level is-mobile" href="#5-2-开启yum缓存"><span class="level-left"><span class="level-item">5.2. 开启yum缓存</span></span></a></li><li><a class="level is-mobile" href="#5-3-开始升级"><span class="level-left"><span class="level-item">5.3. 开始升级</span></span></a></li></ul></li><li><a class="level is-mobile" href="#6-gitlab迁移"><span class="level-left"><span class="level-item">6. gitlab迁移</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#6-1-备份数据"><span class="level-left"><span class="level-item">6.1. 备份数据</span></span></a></li><li><a class="level is-mobile" href="#6-2-在新服务器上安装gitlab"><span class="level-left"><span class="level-item">6.2. 在新服务器上安装gitlab</span></span></a></li><li><a class="level is-mobile" href="#6-3-还原备份"><span class="level-left"><span class="level-item">6.3. 还原备份</span></span></a></li></ul></li><li><a class="level is-mobile" href="#7-如何彻底卸载gitlab"><span class="level-left"><span class="level-item">7. 如何彻底卸载gitlab?</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#7-1-卸载前备份"><span class="level-left"><span class="level-item">7.1. 卸载前备份</span></span></a></li><li><a class="level is-mobile" href="#7-2-执行卸载"><span class="level-left"><span class="level-item">7.2. 执行卸载</span></span></a></li></ul></li><li><a class="level is-mobile" href="#8-问题排查"><span class="level-left"><span class="level-item">8. 问题排查</span></span></a></li><li><a class="level is-mobile" href="#9-关联阅读"><span class="level-left"><span class="level-item">9. 关联阅读</span></span></a></li></ul></div></div><style>#toc .menu-list>li>a.is-active+.menu-list{display:block}#toc .menu-list>li>a+.menu-list{display:none}</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2024-09-13T04:00:00.000Z">2024-09-13</time></p><p class="title"><a href="/astro/astro_authentication.html">为 Astro 网站添加身份验证鉴权功能</a></p><p class="categories"><a href="/categories/tools/">tools</a> / <a href="/categories/tools/Astro/">Astro</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2024-09-13T04:00:00.000Z">2024-09-13</time></p><p class="title"><a href="/product/query_on_auth_and_business_decoupled_systems.html">在身份验证鉴权与业务分离的系统中, 如何实现根据用户属性查询业务信息?</a></p><p class="categories"><a href="/categories/others/">others</a> / <a href="/categories/others/marketing/">marketing</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2024-09-12T04:00:00.000Z">2024-09-12</time></p><p class="title"><a href="/astro/astro_blog_comments.html">使用 Giscus 为 Astro 网站添加评论功能</a></p><p class="categories"><a href="/categories/tools/">tools</a> / <a href="/categories/tools/Astro/">Astro</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2024-09-09T04:00:00.000Z">2024-09-09</time></p><p class="title"><a href="/astro/astro_install_and_configure.html">使用 Astro 快速搭建自己的博客系统</a></p><p class="categories"><a href="/categories/tools/">tools</a> / <a href="/categories/tools/Astro/">Astro</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2024-09-04T04:00:00.000Z">2024-09-04</time></p><p class="title"><a href="/linux/linux_systemd_service_explanation.html">Linux systemd 服务详解</a></p><p class="categories"><a href="/categories/OS/">OS</a> / <a href="/categories/OS/linux/">linux</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/09/"><span class="level-start"><span class="level-item">九月 2024</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/08/"><span class="level-start"><span class="level-item">八月 2024</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/07/"><span class="level-start"><span class="level-item">七月 2024</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/06/"><span class="level-start"><span class="level-item">六月 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/05/"><span class="level-start"><span class="level-item">五月 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/04/"><span class="level-start"><span class="level-item">四月 2024</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/03/"><span class="level-start"><span class="level-item">三月 2024</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">二月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/01/"><span class="level-start"><span class="level-item">一月 2024</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/12/"><span class="level-start"><span class="level-item">十二月 2023</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/11/"><span class="level-start"><span class="level-item">十一月 2023</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/10/"><span class="level-start"><span class="level-item">十月 2023</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/09/"><span class="level-start"><span class="level-item">九月 2023</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/08/"><span class="level-start"><span class="level-item">八月 2023</span></span><span class="level-end"><span class="level-item tag">25</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/07/"><span class="level-start"><span class="level-item">七月 2023</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/06/"><span class="level-start"><span class="level-item">六月 2023</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/05/"><span class="level-start"><span class="level-item">五月 2023</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/04/"><span class="level-start"><span class="level-item">四月 2023</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/03/"><span class="level-start"><span class="level-item">三月 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">二月 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">一月 2023</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/12/"><span class="level-start"><span class="level-item">十二月 2022</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/11/"><span class="level-start"><span class="level-item">十一月 2022</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">十月 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/09/"><span class="level-start"><span class="level-item">九月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/08/"><span class="level-start"><span class="level-item">八月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">七月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">六月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">五月 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">四月 2022</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">三月 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">一月 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">十二月 2021</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">十一月 2021</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">29</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">鹏叔的技术博客</a><p class="is-size-7"><span>&copy; 2024 鹏叔</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Follow on GitHub" href="https://github.com/guoapeng"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("zh-cn")</script><script>var IcarusThemeSettings={article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script data-pjax src="/js/column.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load",()=>{"function"==typeof $.fn.lightGallery&&$(".article").lightGallery({selector:".gallery-item"}),"function"==typeof $.fn.justifiedGallery&&($(".justified-gallery > p > .gallery-item").length&&$(".justified-gallery > p > .gallery-item").unwrap(),$(".justified-gallery").justifiedGallery())})</script><script src="https://cdnjs.loli.net/ajax/libs/pjax/0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener("DOMContentLoaded",function(){loadInsight({contentUrl:"/content.json"},{hint:"想要查找什么...",untitled:"(无标题)",posts:"文章",pages:"页面",categories:"分类",tags:"标签"})})</script><script type="text/javascript" src="/js/imaegoo/universe.js"></script></body></html>